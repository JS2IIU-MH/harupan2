# Harupan2

## 1. アプリ概要

某食品メーカー祭りのシールをカメラでリアルタイム認識し、シールの点数を自動計算して合計点を表示するモバイルアプリ。

- **アプリ表示名**：Harupan2
- **アプリアイコン**：/assets/icon/icon.png

## 2. 対象プラットフォーム

- iOS / Android（Flutter によるクロスプラットフォーム開発）

## 3. 技術スタック

| 区分 | 技術 |
|------|------|
| フレームワーク | Flutter |
| 物体検出モデル | YOLOv8（ONNX） |
| 推論エンジン | onnxruntime_flutter（オンデバイス推論） |
| 状態管理 | Riverpod |
| 多言語対応 | flutter_localizations（日本語、英語は後日追加） |

## 4. デザイン

| 項目 | 値 |
|------|------|
| メインカラー | `#134A96` |
| アクセントカラー | `#E4004F` |
| アプリアイコン | 後日設定 |

## 5. 認識対象シールと点数

| ラベル | 点数 |
|--------|------|
| p05 | 0.5 点 |
| p10 | 1.0 点 |
| p15 | 1.5 点 |
| p20 | 2.0 点 |
| p25 | 2.5 点 |
| p30 | 3.0 点 |

## 6. 推論パラメータ

| パラメータ | 値 | 備考 |
|------------|------|------|
| モデル入力サイズ | 640 × 640 | |
| 信頼度スコア閾値 | 0.6 | 変更しやすいよう定数化する |
| NMS IoU 閾値 | 0.45 | 標準的な値（変更しやすいよう定数化する） |

## 7. 画面構成

### 7.1 構成
- **1 スクリーン構成**（単一画面アプリ）
- アプリ起動時にカメラ ON → リアルタイム認識を即時開始

### 7.2 UI レイヤー（下から順）
1. **カメラプレビュー**（背面カメラ映像）
2. **バウンディングボックス**（検出されたシールごとにラベル・点数を表示）
3. **合計点表示**（画面中央に大きな文字で半透明表示、カメラ映像に重畳）
4. **操作 UI**（カメラ前面/背面切替ボタン、シェアボタン）

## 8. 主な機能

### 8.1 リアルタイムカメラ認識
- カメラ映像からシールをリアルタイムで検出・分類
- 検出されたシールにバウンディングボックスを描画
- 各シールの点数を即時表示
- 合計点数を自動計算して画面中央に半透明の大文字で表示
- **推論フレームレート目標**：約 10 fps
- **デフォルトカメラ**：背面カメラ
- **カメラ切替**：ユーザー操作で前面 / 背面カメラを切替可能

### 8.2 シェア機能（SNS 連携）
- スクリーンショット + 合計点 + ハッシュタグ `#harupan2` をシェア
- **OS 標準のシェアシート**を使用

## 9. エラーハンドリング

| ケース | 対応 |
|--------|------|
| カメラ権限が拒否された場合 | ダイアログでカメラ権限の許可を促すメッセージを表示し、設定画面への誘導を行う |

## 10. 配布方法

- Google Play Store（Android）
- Apple App Store（iOS）

## 11. ターゲットユーザー

- 一般公開（某食品メーカーの祭りに参加する一般消費者）

